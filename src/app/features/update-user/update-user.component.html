<form [formGroup]="form" (ngSubmit)="submit()">
  <div class="p-3">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
      <div>
        <app-custom-input formControlName="first_name" label="First name" />
      </div>
      <div>
        <app-custom-input formControlName="last_name" label="Last name" />
      </div>
    </div>
    <div class="mb-4">
      <app-custom-input label="Email" [ngModel]="user.email" [ngModelOptions]="{ standalone: true }" disabled />
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
      <div>
        <app-checkbox-select
          formControlName="tenants"
          [options]="tenants()"
          labelField="name"
          valueField="id"
          placeholder="Tenants"
        />
      </div>
      <div>
        <h4>Roles</h4>
        @if (!updatingRoles()) {
          @for (role of roles(); track $index) {
            <div class="flex gap-2 items-center px-2">
              <input
                [value]="role.id"
                type="checkbox"
                [id]="'user_role_' + $index"
                (change)="toggleRole(role.id, isChecked(role.id) ? 'remove' : 'add')"
                [checked]="isChecked(role.id)"
              />
              <label class="grow" [for]="'user_role_' + $index">{{ role.name }}</label>
            </div>
          }
        } @else {
          <div class="loader"></div>
        }
      </div>
    </div>
  </div>

  <div class="flex gap-4 justify-end mt-6 md:flex-row flex-col text-center max-md:w-full">
    @if (!loading()) {
      <button
        class="items-center gap-2 bg-zinc-200 px-4 py-2 rounded-lg md:flex"
        type="button"
        (click)="userUpdated.emit(false)"
      >
        Cancel
      </button>
      <button class="bg-secondary px-4 py-2 rounded-lg text-white" type="submit">Save</button>
    } @else {
      <div class="loader"></div>
    }
  </div>
</form>
